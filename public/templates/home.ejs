<%- include('./layouts/header') -%>
<body>
  <%- include('./layouts/nav') -%> <%- include('./layouts/sidenav') %>
  <div class="page-body">
    <div class="page-name">
      <h1>Document Tracker</h1>
    </div>
    <%# Upload form %>
    <div class="upload-container">
      <form action="/upload" method="post" enctype="multipart/form-data">
        <div class="form-group" style="display: flex">
          <input
            type="file"
            class="form-control"
            name="file"
            accept=".doc, .docx, .pdf, .xlsx"
            style="width: 300px"
            required
          />
          <button
            class="btn btn-secondary"
            type="submit"
            style="margin-left: 10px"
          >
            Upload
          </button>
        </div>
      </form>
    </div>
    <%# Search bar %>
    <input
      class="form-control me-sm-2"
      type="text"
      id="searchInput"
      placeholder="Search"
      style="margin-bottom: 20px"
    />
    <%# Filter %>
    <div class="sortation-container">
      <div
        class="btn-group filter-radio"
        role="group"
        aria-label="Basic radio toggle button group"
      >
        <input
          type="radio"
          class="btn-check"
          name="btnradio"
          id="btnradio1"
          autocomplete="off"
          checked=""
        />
        <label
          class="btn btn-secondary filter-btn"
          for="btnradio1"
          data-extension="all"
          >All</label
        >
        <input
          type="radio"
          class="btn-check"
          name="btnradio"
          id="btnradio2"
          autocomplete="off"
        />
        <label
          class="btn btn-secondary filter-btn"
          for="btnradio2"
          data-extension="pdf"
          >PDF</label
        >
        <input
          type="radio"
          class="btn-check"
          name="btnradio"
          id="btnradio3"
          autocomplete="off"
        />
        <label
          class="btn btn-secondary filter-btn"
          for="btnradio3"
          data-extension="docx"
          >DOCX</label
        >
        <input
          type="radio"
          class="btn-check"
          name="btnradio"
          id="btnradio4"
          autocomplete="off"
        />
        <label
          class="btn btn-secondary filter-btn"
          for="btnradio4"
          data-extension="excel"
          >EXCEL</label
        >
      </div>

      <div class="btn-group btn-group-toggle">
        <button class="btn btn-primary sort-btn">Sort by Recent</button>
        <button class="btn btn-primary toggle-sort-btn">
          Toggle Alphabetical Order
        </button>
      </div>
    </div>
    <!-- Sort button -->

    <%# File list %>
    <div class="page-container">
      <% files.forEach(file => { %>
      <div class="page-item">
        <div class="card mb-3">
          <h3 class="card-header"></h3>
          <a href="#" class="hover-div">
            <!-- SVG element to display different icons based on file extension -->
            <% if (file.name.endsWith('.pdf')) { %>
            <svg
              class="svg-trigger"
              xmlns="http://www.w3.org/2000/svg"
              class="d-block user-select-none"
              width="100%"
              height="200"
              aria-label="PDF File"
              focusable="false"
              role="img"
              preserveAspectRatio="xMidYMid slice"
              viewBox="0 0 318 180"
              style="font-size: 1.125rem; text-anchor: middle"
            >
              <rect width="100%" height="100%" fill="#8B0000"></rect>
              <text x="50%" y="50%" fill="#dee2e6" dy=".3em">PDF</text>
            </svg>
            <% } else if (file.name.endsWith('.docx')) { %>
            <svg
              class="svg-trigger-docx"
              xmlns="http://www.w3.org/2000/svg"
              class="d-block user-select-none"
              width="100%"
              height="200"
              aria-label="DOCX File"
              focusable="false"
              role="img"
              preserveAspectRatio="xMidYMid slice"
              viewBox="0 0 318 180"
              style="font-size: 1.125rem; text-anchor: middle"
            >
              <rect width="100%" height="100%" fill="#007bff"></rect>
              <text x="50%" y="50%" fill="#dee2e6" dy=".3em">DOCX</text>
            </svg>
            <% } else if (file.name.endsWith('.xlsx')) { %>
            <svg
              class="svg-trigger-docx"
              xmlns="http://www.w3.org/2000/svg"
              class="d-block user-select-none"
              width="100%"
              height="200"
              aria-label="EXCEL File"
              focusable="false"
              role="img"
              preserveAspectRatio="xMidYMid slice"
              viewBox="0 0 318 180"
              style="font-size: 1.125rem; text-anchor: middle"
            >
              <rect width="100%" height="100%" fill="#1e9004"></rect>
              <text x="50%" y="50%" fill="#dee2e6" dy=".3em">EXCEL</text>
            </svg>
            <% } else { %>
            <!-- Default icon for other file types -->
            <svg
              class="svg-trigger"
              xmlns="http://www.w3.org/2000/svg"
              class="d-block user-select-none"
              width="100%"
              height="200"
              aria-label="Placeholder: Image cap"
              focusable="false"
              role="img"
              preserveAspectRatio="xMidYMid slice"
              viewBox="0 0 318 180"
              style="font-size: 1.125rem; text-anchor: middle"
            >
              <rect width="100%" height="100%" fill="#868e96"></rect>
              <text x="50%" y="50%" fill="#dee2e6" dy=".3em">
                <%= file.name.endsWith('.pdf') ? 'PDF' : 'DOCX' %>
              </text>
            </svg>
            <% } %>
          </a>
          <div class="card-body">
            <p class="card-text"><%= file.name %></p>
          </div>
          <div class="card-body">
            <a href="/download/<%= file.name %>" class="card-link"
              >Download File</a
            >
            <% if (file.name.endsWith('.docx')) { %>
            <a
              href="#"
              class="card-link convert-link"
              data-filename="<%= file.name %>"
              >Convert</a
            >
            <% } %>

            <a
              href="#"
              class="btn-delete .delete-btn"
              style="color: red"
              data-file="<%= file.name %>"
              >Delete</a
            >
          </div>
          <div class="card-footer text-muted"><%= file.mtime %></div>
        </div>
      </div>
      <% }) %>
    </div>
  </div>
  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <iframe
        type="application/pdf"
        id="pdfViewer"
        src=""
        width="100%"
        height="100%"
        frameborder="0"
        toolbar="0"
        scrollbar="0"
      ></iframe>
      <span id="enlargeButton" class="enlargeButton">Enlarge</span>
    </div>
  </div>
  <div class="page-footer"></div>
</body>
<%- include('./layouts/footer') -%>
