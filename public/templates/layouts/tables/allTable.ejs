
<input
  class="form-control me-sm-2 mt-4"
  type="text"
  id="filesInput"
  placeholder="Search"
  oninput="searchTable3()"
/>
<% if (todayFiles.length > 0) { %>
<h3 id="todayLabel" class="mt-3">Today's Tasks:</h3>
<table id="todayTasksTable" class="table table-hover table-striped mt-4">
  <thead>
    <tr class="table-dark">
      <th style="width: 200px">File Code</th>
      <th style="width: 200px">File Name</th>
      <th style="width: 150px">Assigned To</th>
      <th style="width: 170px">Date Assigned</th>
      <th style="width: 170px">Due Date</th>
      <th style="width: 90px">Status</th>
      <th style="width: 10px; padding-left: 30px"></th>
    </tr>
  </thead>
  <tbody>
    <% todayFiles.forEach((file, index) => { %>
    <tr>
      <td>
        <%= file.fileCode.length > 20 ? file.fileCode.substring(0, 20) + '...' :
        file.fileCode %>
      </td>
      <td>
        <%= file.fileName.length > 15 ? file.fileName.substring(0, 15) + '...' :
        file.fileName %>
      </td>
      <td><%= file.assignTo %></td>
      <td><%= file.dateSubmitted.toISOString().split('T')[0] %></td>
      <td><%= file.dueDate.toISOString().split('T')[0] %></td>
      <td>
        <% if (file.status === 'APPROVED') { %>
        <span class="badge bg-success">APPROVED</span>
        <% } else if (file.status === 'REJECTED') { %>
        <span class="badge bg-danger">REJECTED</span>
        <% } else if (file.status === 'PENDING' || file.status === 'FOR APPROVAL') { %>
        <span class="badge bg-warning">PENDING</span>
        <% } else { %>
        <span class="badge bg-primary">UNKNOWN</span>
        <% } %>
      </td>
      <td class="action-buttons">
        <a href="view_file/<%= file.id %>" class="icon-square text-dark"
          ><i class="fa-solid fa-eye"></i
        ></a>
        <a href="/archive_file/<%= file.id %>" class="icon-square text-warning" data-bs-toggle="modal" data-bs-target="#archiveModal2"
          ><i class="fa-solid fa-box-archive"></i>
        </a>
      </td>
    </tr>
    <% }); %>
  </tbody>
</table>
<% } %>
<% if (currentWeekFiles.length > 0) { %>
  <h3 id="weekLabel" class="mt-4">Later This Week:</h3>
  <table id="laterThisWeekTable" class="table table-hover table-striped mt-4">
    <thead>
      <tr class="table-dark">
        <th style="width: 200px">File Code</th>
        <th style="width: 200px">File Name</th>
        <th style="width: 150px">Assigned To</th>
        <th style="width: 170px">Date Assigned</th>
        <th style="width: 170px">Due Date</th>
        <th style="width: 90px">Status</th>
        <th style="width: 10px; padding-left: 30px"></th>
      </tr>
    </thead>
    <tbody>
      <% currentWeekFiles.forEach((file, index) => { %>
      <tr>
        <td>
          <%= file.fileCode.length > 20 ? file.fileCode.substring(0, 20) + '...' :
          file.fileCode %>
        </td>
        <td>
          <%= file.fileName.length > 15 ? file.fileName.substring(0, 15) + '...' :
          file.fileName %>
        </td>
        <td><%= file.assignTo %></td>
        <td><%= file.dateSubmitted.toISOString().split('T')[0] %></td>
        <td><%= file.dueDate.toISOString().split('T')[0] %></td>
        <td>
          <% if (file.status === 'APPROVED') { %>
          <span class="badge bg-success">APPROVED</span>
          <% } else if (file.status === 'REJECTED') { %>
          <span class="badge bg-danger">REJECTED</span>
          <% } else if (file.status === 'PENDING') { %>
          <span class="badge bg-warning">PENDING</span>
          <% } else if (file.status === 'FOR APPROVAL') { %>
          <span class="badge bg-warning">FOR APPROVAL</span>
          <% } else { %>
          <span class="badge bg-primary">UNKNOWN</span>
          <% } %>
        </td>
        <td class="action-buttons">
          <a href="view_file/<%= file.id %>" class="icon-square text-dark"
            ><i class="fa-solid fa-eye"></i
          ></a>
          <a href="/archive_file/<%= file.id %>" class="icon-square text-warning" data-bs-toggle="modal" data-bs-target="#archiveModal2"
            ><i class="fa-solid fa-box-archive"></i>
          </a>
        </td>
      </tr>
      <% }); %>
    </tbody>
  </table>
  <p id="noFiles" style="display: none;" class="text-muted text-center">No Files Found</p>
<!-- Pagination Links -->
<div class="pagination justify-content-center">
  <% if (totalPages > 1) { %>
  <ul class="pagination justify-content-center">
    <% for (let i = 1; i <= totalPages; i++) { %>
    <li class="page-item <%= currentPage === i ? 'active' : '' %>">
      <a href="?page=<%= i %>" class="page-link"><%= i %></a>
    </li>
    <% } %>
  </ul>
  <% } %>
</div>
<% } %>

<script>
  function searchTable3() {
    const input = document.getElementById('filesInput').value.toLowerCase();

    // Search in Today's Tasks table
    const todayRows = document.querySelectorAll('#todayTasksTable tbody tr');
    const todayTable = document.getElementById('todayTasksTable');
    const todayTableHeader = todayTable.querySelector('thead');
    const todayLabel = document.getElementById('todayLabel');

    let todayMatch = false;
    todayRows.forEach(row => {
      const fileCode = row.cells[0].textContent.toLowerCase();
      const fileName = row.cells[1].textContent.toLowerCase();

      if (fileCode.includes(input) || fileName.includes(input)) {
        row.style.display = '';
        todayMatch = true;
      } else {
        row.style.display = 'none';
      }
    });

    todayTableHeader.style.display = todayMatch ? '' : 'none';
    todayLabel.style.display = todayMatch ? '' : 'none';

    // Search in Later This Week table
    const laterRows = document.querySelectorAll('#laterThisWeekTable tbody tr');
    const laterTable = document.getElementById('laterThisWeekTable');
    const laterTableHeader = laterTable.querySelector('thead');
    const weekLabel = document.getElementById('weekLabel');

    let laterMatch = false;
    laterRows.forEach(row => {
      const fileCode = row.cells[0].textContent.toLowerCase();
      const fileName = row.cells[1].textContent.toLowerCase();

      if (fileCode.includes(input) || fileName.includes(input)) {
        row.style.display = '';
        laterMatch = true;
      } else {
        row.style.display = 'none';
      }
    });

    laterTableHeader.style.display = laterMatch ? '' : 'none';
    weekLabel.style.display = laterMatch ? '' : 'none';

    const noFilesMessage = document.getElementById('noFiles');
      if (!todayMatch && !laterMatch) {
        noFilesMessage.style.display = '';
      } else {
        noFilesMessage.style.display = 'none';
      }
  }
</script>
  